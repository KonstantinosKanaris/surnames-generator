<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>surnames_generator.engine package &mdash; surnames-generator  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="surnames_generator.factories package" href="surnames_generator.factories.html" />
    <link rel="prev" title="surnames_generator.data package" href="surnames_generator.data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            surnames-generator
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">surnames_generator</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="surnames_generator.html">surnames_generator package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="surnames_generator.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="surnames_generator.data.html">surnames_generator.data package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">surnames_generator.engine package</a></li>
<li class="toctree-l4"><a class="reference internal" href="surnames_generator.factories.html">surnames_generator.factories package</a></li>
<li class="toctree-l4"><a class="reference internal" href="surnames_generator.utils.html">surnames_generator.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="surnames_generator.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="surnames_generator.html#module-surnames_generator.controllers">surnames_generator.controllers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="surnames_generator.html#module-surnames_generator.models">surnames_generator.models module</a></li>
<li class="toctree-l3"><a class="reference internal" href="surnames_generator.html#module-surnames_generator">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">surnames-generator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">surnames_generator</a></li>
          <li class="breadcrumb-item"><a href="surnames_generator.html">surnames_generator package</a></li>
      <li class="breadcrumb-item active">surnames_generator.engine package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/surnames_generator.engine.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="surnames-generator-engine-package">
<h1>surnames_generator.engine package<a class="headerlink" href="#surnames-generator-engine-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-surnames_generator.engine.generator">
<span id="surnames-generator-engine-generator-module"></span><h2>surnames_generator.engine.generator module<a class="headerlink" href="#module-surnames_generator.engine.generator" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="surnames_generator.engine.generator.SurnamesGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">surnames_generator.engine.generator.</span></span><span class="sig-name descname"><span class="pre">SurnamesGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectorizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="surnames_generator.utils.html#surnames_generator.utils.vectorizers.CharacterVectorizer" title="surnames_generator.utils.vectorizers.CharacterVectorizer"><span class="pre">CharacterVectorizer</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#surnames_generator.engine.generator.SurnamesGenerator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generates random surnames or surnames biased
towards a provided nationality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vectorizer</strong> (<a class="reference internal" href="surnames_generator.utils.html#surnames_generator.utils.vectorizers.CharacterVectorizer" title="surnames_generator.utils.vectorizers.CharacterVectorizer"><em>CharacterVectorizer</em></a>) – The surnames vectorizer for
accessing the vocabulary.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="surnames_generator.engine.generator.SurnamesGenerator.vectorizer">
<span class="sig-name descname"><span class="pre">vectorizer</span></span><a class="headerlink" href="#surnames_generator.engine.generator.SurnamesGenerator.vectorizer" title="Link to this definition"></a></dt>
<dd><p>The surnames vectorizer for
accessing the vocabulary.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="surnames_generator.utils.html#surnames_generator.utils.vectorizers.CharacterVectorizer" title="surnames_generator.utils.vectorizers.CharacterVectorizer">CharacterVectorizer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.generator.SurnamesGenerator.conditioned_sample_generation">
<span class="sig-name descname"><span class="pre">conditioned_sample_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nationalities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#surnames_generator.engine.generator.SurnamesGenerator.conditioned_sample_generation" title="Link to this definition"></a></dt>
<dd><p>Generates a number of sequences consisting of character indices.</p>
<p>Each sequence of indices represents a surname, biased towards the
given nationality index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The trained model to generate indices.</p></li>
<li><p><strong>nationalities</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of indices representing nationalities.</p></li>
<li><p><strong>sample_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the generated sequences
(default=20).</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Accentuates of flattens the distribution.
0.0 &lt; temperature &lt; 1.0 makes the distribution peakier.
temperature &gt; 1.0 makes the distribution more uniform.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Outputs: indices</dt><dd><ul class="simple">
<li><p><strong>indices</strong>: tensor of shape <span class="math notranslate nohighlight">\((N, L)\)</span>.</p></li>
</ul>
<p>where:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    N ={} &amp; \text{batch size} \\
    L ={} &amp; \text{sequence length} \\
\end{aligned}\end{split}\]</div>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.generator.SurnamesGenerator.decode_samples">
<span class="sig-name descname"><span class="pre">decode_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampled_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#surnames_generator.engine.generator.SurnamesGenerator.decode_samples" title="Link to this definition"></a></dt>
<dd><p>Transforms the generated sequences of indices to
readable surnames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sampled_indices</strong> (<em>torch.Tensor</em>) – The generated sample of
sequence indices.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated surnames.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.generator.SurnamesGenerator.generate_conditioned_surnames">
<span class="sig-name descname"><span class="pre">generate_conditioned_surnames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nationality_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#surnames_generator.engine.generator.SurnamesGenerator.generate_conditioned_surnames" title="Link to this definition"></a></dt>
<dd><p>Generates a sample of surnames, biased towards the
given nationality index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The trained model to generate indices.</p></li>
<li><p><strong>nationality_idx</strong> (<em>int</em>) – The nationality index.</p></li>
<li><p><strong>sample_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Max number of generated indices (number
of characters in the surname) (default=20).</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of surnames to generate
(default=1).</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Accentuates of flattens the distribution.
0.0 &lt; temperature &lt; 1.0 makes the distribution peakier.
temperature &gt; 1.0 makes the distribution more uniform.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated surnames.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.generator.SurnamesGenerator.generate_unconditioned_surnames">
<span class="sig-name descname"><span class="pre">generate_unconditioned_surnames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#surnames_generator.engine.generator.SurnamesGenerator.generate_unconditioned_surnames" title="Link to this definition"></a></dt>
<dd><p>Generates a sample of random surnames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The trained model to generate indices.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of surnames to generate
(default=1).</p></li>
<li><p><strong>sample_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Max number of generated indices (number
of characters in the surname) (default=20).</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Accentuates of flattens the distribution.
0.0 &lt; temperature &lt; 1.0 makes the distribution peakier.
temperature &gt; 1.0 makes the distribution more uniform.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated surnames.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.generator.SurnamesGenerator.unconditioned_sample_generation">
<span class="sig-name descname"><span class="pre">unconditioned_sample_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#surnames_generator.engine.generator.SurnamesGenerator.unconditioned_sample_generation" title="Link to this definition"></a></dt>
<dd><p>Generates a number of sequences consisting of character
indices.</p>
<p>Each sequence of indices represents a random surname.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The trained model to generate indices.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Batch size. Number of sequences to
generate (default=1).</p></li>
<li><p><strong>sample_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the generated sequences
(default=20).</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Accentuates of flattens the distribution.
0.0 &lt; temperature &lt; 1.0 makes the distribution peakier.
temperature &gt; 1.0 makes the distribution more uniform.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Outputs: indices</dt><dd><ul class="simple">
<li><p><strong>indices</strong>: tensor of shape <span class="math notranslate nohighlight">\((N, L)\)</span>.</p></li>
</ul>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    N ={} &amp; \text{batch size} \\
    L ={} &amp; \text{sequence length} \\
\end{aligned}\end{split}\]</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-surnames_generator.engine.trainer">
<span id="surnames-generator-engine-trainer-module"></span><h2>surnames_generator.engine.trainer module<a class="headerlink" href="#module-surnames_generator.engine.trainer" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="surnames_generator.engine.trainer.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">surnames_generator.engine.trainer.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ReduceLROnPlateau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="surnames_generator.utils.html#surnames_generator.utils.vectorizers.CharacterVectorizer" title="surnames_generator.utils.vectorizers.CharacterVectorizer"><span class="pre">CharacterVectorizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_softmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#surnames_generator.engine.trainer.Trainer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for training a character-based seq-to-seq text
generation PyTorch model.</p>
<p>Incorporates functionalities such as early stopping,
learning rate reduction, resume from checkpoint, and
MLFlow tracking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint_path</strong> (<em>str</em>) – The file path to save or load a
checkpoint.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The PyTorch model to be trained.</p></li>
<li><p><strong>loss_fn</strong> (<em>torch.nn.Module</em>) – The loss function used for
optimization.</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – The optimizer used for
updating model parameters.</p></li>
<li><p><strong>scheduler</strong> – Reduces the learning rate when the validation
loss stops improving.</p></li>
<li><p><strong>vectorizer</strong> (<a class="reference internal" href="surnames_generator.utils.html#surnames_generator.utils.vectorizers.CharacterVectorizer" title="surnames_generator.utils.vectorizers.CharacterVectorizer"><em>CharacterVectorizer</em></a>) – Vectorizes a text sequence
to observations <cite>X</cite> and targets <cite>y</cite>.</p></li>
<li><p><strong>epochs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of training epochs
(default=5).</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of epochs to wait before</p></li>
<li><p><strong>stopping</strong> (<em>early</em>) – </p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum change in monitored quantity
to qualify as an improvement (default=0).</p></li>
<li><p><strong>resume</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, resumes training from
the specified checkpoint. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>mask_index</strong> (<em>int</em><em>, </em><em>optional</em>) – The masking index to ignore during
the calculation of loss and accuracy metrics (default=0).</p></li>
<li><p><strong>apply_softmax</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the model applies
<cite>nn.LogSoftmax()</cite> to the prediction logits during the
forward pass. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="surnames_generator.engine.trainer.Trainer.DEVICE">
<span class="sig-name descname"><span class="pre">DEVICE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'cpu'</span></em><a class="headerlink" href="#surnames_generator.engine.trainer.Trainer.DEVICE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.trainer.Trainer.compute_accuracy">
<span class="sig-name descname"><span class="pre">compute_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#surnames_generator.engine.trainer.Trainer.compute_accuracy" title="Link to this definition"></a></dt>
<dd><p>Returns the computed accuracy value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<em>torch.Tensor</em>) – The output of the model.</p></li>
<li><p><strong>y_true</strong> (<em>torch.Tensor</em>) – The target predictions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.trainer.Trainer.sequence_loss">
<span class="sig-name descname"><span class="pre">sequence_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#surnames_generator.engine.trainer.Trainer.sequence_loss" title="Link to this definition"></a></dt>
<dd><p>Normalizes the tensor sizes and calculates the
loss of the sequence predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<em>torch.Tensor</em>) – The output of the model.</p></li>
<li><p><strong>y_true</strong> (<em>torch.Tensor</em>) – The target predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated sequence loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.trainer.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#surnames_generator.engine.trainer.Trainer.train" title="Link to this definition"></a></dt>
<dd><p>Trains a seq-to-seq text generation PyTorch model.</p>
<p>The training routine expects from the dataloaders to provide
two sequence of integers which represent the token observations,
and the token targets at each time step.</p>
<p>Performs the training using the provided dataloaders, loss function,
and optimizer. It also performs evaluation on the validation data at
the end of each epoch. Checkpointing is supported, optionally allowing
for the resumption of training from a saved checkpoint.</p>
<p>The training process includes learning rate reduction and early stopping
to prevent over-fitting. The training loop stops if the validation loss
does not improve for a certain number of epochs, defined from the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">patience</span></code> class attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – A <cite>DataLoader</cite> instance for providing batches of
training data.</p></li>
<li><p><strong>val_dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – A <cite>DataLoader</cite> instance for providing batches of
validation data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-surnames_generator.engine.utils">
<span id="surnames-generator-engine-utils-module"></span><h2>surnames_generator.engine.utils module<a class="headerlink" href="#module-surnames_generator.engine.utils" title="Link to this heading"></a></h2>
<p>Supported functionality for the training process.</p>
<dl class="py class">
<dt class="sig sig-object py" id="surnames_generator.engine.utils.EarlyStopping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">surnames_generator.engine.utils.</span></span><span class="sig-name descname"><span class="pre">EarlyStopping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./checkpoint.pt'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#surnames_generator.engine.utils.EarlyStopping" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implements early stopping during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of epochs to wait before early stopping.
(default=5).</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum change in monitored quantity to qualify
as an improvement (default=0).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prints a message for each improvement.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to save the checkpoint. Should include either
<cite>.pth</cite> or <cite>.pt</cite> as the file extension. Defaults to
<code class="docutils literal notranslate"><span class="pre">'./checkpoint.pt'</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="surnames_generator.engine.utils.EarlyStopping.save_general_checkpoint">
<span class="sig-name descname"><span class="pre">save_general_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#surnames_generator.engine.utils.EarlyStopping.save_general_checkpoint" title="Link to this definition"></a></dt>
<dd><p>Saves a general checkpoint during training.</p>
<p>In addition to the model’s <cite>state_dict</cite>, a general checkpoint
also includes the optimizer’s <cite>state_dict</cite>, the current epoch,
and the validation loss value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – Current epoch.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Model to be saved.</p></li>
<li><p><strong>val_loss</strong> (<em>float</em>) – Validation loss at the time of saving
the checkpoint.</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – Optimizer used for
training.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="surnames_generator.engine.utils.normalize_tensors">
<span class="sig-prename descclassname"><span class="pre">surnames_generator.engine.utils.</span></span><span class="sig-name descname"><span class="pre">normalize_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#surnames_generator.engine.utils.normalize_tensors" title="Link to this definition"></a></dt>
<dd><p>Normalizes tensor sizes.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">y_pred</span></code> is a 3-D tensor, reshapes it to a 2-D matrix.
If <code class="xref py py-attr docutils literal notranslate"><span class="pre">y_true</span></code> is a 2-D matrix, reshapes it to a 1-D vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<em>torch.Tensor</em>) – The output of the model.</p></li>
<li><p><strong>y_true</strong> (<em>torch.Tensor</em>) – The target predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalized tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="surnames_generator.engine.utils.plot_grad_flow">
<span class="sig-prename descclassname"><span class="pre">surnames_generator.engine.utils.</span></span><span class="sig-name descname"><span class="pre">plot_grad_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">named_parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#surnames_generator.engine.utils.plot_grad_flow" title="Link to this definition"></a></dt>
<dd><p>Plots the gradients flowing through different layers
in the net during training. Can be used for checking for
possible gradient vanishing / exploding problems.</p>
<p>Usage: Plug this function in Trainer class after loss.backwards() as
“plot_grad_flow(self.model.named_parameters())” to visualize the
gradient flow.</p>
</dd></dl>

</section>
<section id="module-surnames_generator.engine">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-surnames_generator.engine" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="surnames_generator.data.html" class="btn btn-neutral float-left" title="surnames_generator.data package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="surnames_generator.factories.html" class="btn btn-neutral float-right" title="surnames_generator.factories package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Konstantinos Kanaris.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>